<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>City of Austin Homelessness Dashboard</title>
    <script
      type="text/javascript"
      src="https://public.tableau.com/javascripts/api/tableau-2.min.js"
    ></script>
    <script type="text/javascript" src="assets/vizList.js"></script>

    <script>
      function initializeViz() {
        // gets lists of urls that we want on the page and their associated html ids from vizList
        // An object that contains options specifying how to embed the viz
        var options = {
          height: "480px",
          width: "100%",
        };

        for (const [key, viz] of Object.entries(vizList)) {
          // console.log(`${key}: ${viz}`);
          // put widgets in their associated html element
          let divId = `section-${viz.section}-layer-${viz.layer}`;
          let url = viz.url;
          let vizDiv = document.getElementById(divId);
          let = new tableau.Viz(vizDiv, url, options);
          // add data attributes for tooltips so they can be referenced later
          let tabId = `section-${viz.section}-layer-${viz.layer}-tab`;
          let vizTab = document.getElementById(tabId);
          vizTab.setAttribute("data-section", viz.section);
          vizTab.setAttribute("data-layer", viz.layer);
        }
      }
      function initializeTooltips() {
        // top rail tooltips
        $(function () {
          $('[data-toggle="tooltip"]').tooltip({
            trigger: "hover focus click",
          });
        });

        // conditional tooltips for graphs
        $('[data-toggle="viz-tooltip"]').tooltip({
          trigger: "hover focus click",
        });
      }

      // for tooltip toggle
      // on click navbar element, run a function
      // the function checks which id is active of that set
      // it returns display: flex; for that associated tooltip (the rest are hidden)
      // could also be used via a mutation observer

      // or: template literal as expression?
      // title of tooltip is based on a conditional expression
      // spoiler alert: this is what i did, but the other options are other potential approaches
    </script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>

  <body onload="initializeViz();initializeTooltips();">
    <div>
      <nav class="coa-box-shadow">
        <div class="container mt-1">
          <div class="row">
            <div class="col-md-3 align-self-center">
              <a class="navbar-brand" href="#">
                <img
                  src="./assets/images/coa-seal.svg"
                  width="253"
                  height="90"
                  class="d-inline-block align-top"
                  alt=""
                />
              </a>
            </div>

            <div class="col-md-8">
              <h1 class="text-center lead pr-5">
                Austin Homelessness Dashboard
              </h1>
              <p class="small">
                This dashboard is an informational resource on the issue of
                homelessness in Austin. The data visualizations featured here
                are created by the City of Austin. The data is gathered by
                Austin’s Continuum of Care, led by the Ending Community
                Homelessness Coalition (ECHO). To view the full set of data,
                visit data.austin.gov.
              </p>
            </div>
            <div class="col-md-1 align-self-center">
              <button
                type="button"
                class="btn btn-dark coa-data-btn float-right"
              >
                Data
              </button>
            </div>
          </div>
        </div>
      </nav>

      <div class="container">
        <div class="row counts mt-5">
          <div class="col-lg">
            <div class="card coa-metric-card">
              <div>
                <span
                  data-toggle="tooltip"
                  data-html="true"
                  data-placement="bottom"
                  title="<p class='text-left'>
                    This count includes anyone who:
                    
                    <ol class='text-left'>
                    
                    <li >Hasn’t received homelessness services in the last 2 years, including those who have previously been homeless or are experiencing homelessness for the first time
                    
                    <li >Anyone who is seeking service for the first time in Austin’s CoC, though they have received services elsewhere. </p>"
                  class="info-icon float-right mr-1"
                  aria-expanded="false"
                  ><img src="/assets/images/information.svg" />
                </span>

                <div class="pb-2 card-body">
                  <div class="row">
                    <!-- VALUE -->
                    <span><h2 class="total">3,339</h2></span>
                  </div>

                  <div class="text-left d-flex flex-row">
                    <img src="/assets/images/person.svg" />
                    <div class="d-flex flex-column ml-2">
                      <!-- METRIC -->
                      <h5 class="mb-0">
                        Newly Homeless
                      </h5>
                      <!-- YEAR -->
                      <h5 class="text-muted">
                        in <span class="year">2018</span>
                      </h5>
                    </div>
                  </div>
                </div>
                <div class="bg-white card-footer">
                  <div
                    class="text-left widget-footer-icon d-flex flex-row card-bottom"
                  >
                    <span class="trend-icon d-flex align-items-center">
                      <img src="/assets/images/caret-up.svg" />
                    </span>
                    <div
                      class="text-muted text-wrap pt-1 pr-1 widget-footer-text ml-2"
                    >
                      Up by <span class="change">326</span> in the last year
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg">
            <div class="card coa-metric-card">
              <div>
                <span
                  data-toggle="tooltip"
                  data-html="true"
                  data-placement="bottom"
                  title="
                  <div class='text-left'>
                  <p>
                    <strong>This Data is Gathered Using the Homeless Management Information System
                    (HMIS)</strong>
                    </p>
                    <p>
                    Everyone who receives services from a CoC funded program is documented in the
                    Homeless Management Information System (HMIS). This system connects service
                    providers within the Continuum of Care (CoC) and allows for a non-duplicated
                    source of truth for each person who accesses their services. The system also
                    helps collect data on the capacity and use of homelessness services, including
                    shelter and supportive housing.
                    </p>
                    <p>
                    <strong>Shelter Types Included in This Count</strong>
                    </p>
                    <p>
                    Safe Haven - A federally funded program that provides temporary shelter to
                    veterans experiencing homelessness who live with mental illness.
                    </p>
                    <p>
                    Emergency Shelter -  A federally funded program that provides people with a
                    place to stay temporarily when they have no permanent residence.
                    </p>
                    <p>
                    Transitional Housing - A federally funded program that provides a supportive,
                    yet temporary type of accommodation that is meant to bridge the gap from
                    homelessness to permanent housing by offering structure, supervision, support,
                    life skills, education, etc.
                    </p></div>"
                  class="info-icon float-right mr-1"
                  aria-expanded="false"
                  ><img src="/assets/images/information.svg" />
                </span>
                <div class="pb-2 card-body">
                  <div class="row">
                    <!-- VALUE -->
                    <span><h2 class="total">4,255</h2></span>
                  </div>
                  <div class="text-left d-flex flex-row">
                    <img src="/assets/images/crane.svg" />

                    <div class="d-flex flex-column ml-2">
                      <!-- METRIC -->
                      <h5 class="mb-0">
                        People Sheltered
                      </h5>
                      <!-- YEAR -->
                      <h5 class="text-muted">
                        in <span class="year">2018</span>
                      </h5>
                    </div>
                  </div>
                </div>
                <div class="bg-white card-footer">
                  <div
                    class="text-left widget-footer-icon d-flex flex-row card-bottom"
                  >
                    <span class="trend-icon d-flex align-items-center">
                      <img src="/assets/images/caret-up.svg" />
                    </span>
                    <div
                      class="text-muted text-wrap pt-1 pr-1 widget-footer-text ml-2"
                    >
                      Up by <span class="change">186</span> in the last year
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg">
            <div class="card coa-metric-card">
              <div>
                <span
                  data-toggle="tooltip"
                  data-html="true"
                  data-placement="bottom"
                  title="
                  <div class='text-left'>
                    <p>
                      <strong>This Data is Gathered Using the Homeless Management Information System
                      (HMIS)</strong>
                      </p>
                      <p>
                      In addition to collecting data on shelter and service use, the HMIS also
                      accounts for all individuals that are stably housed through programs funded by
                      Austin’s Continuum of Care.
                      </p>
                      <p>
                      <strong>Who is counted</strong>
                      </p>
                      <p>
                      This count is done every fiscal year and includes individuals that have been
                      housed for 6 months or more as well as people who are newly transitioned to a
                      stably housed status. This number does not account for individuals who manage to
                      get housed in non-CoC housing.
                      </p>
                      <p>
                      <strong>Where people are transitioning from</strong>
                      </p>
                      <p>
                      This number includes individuals that have transitioned to stable housing from a
                      shelter and people who have transitioned to stable housing from street
                      homelessness. It also includes people who have transitioned from one permanent
                      housing placement to another, such as moving between Permanent Supportive
                      Housing and more independent housing options.
                      </p></div>"
                  class="info-icon float-right mr-1"
                  aria-expanded="false"
                  ><img src="/assets/images/information.svg" />
                </span>
                <div class="pb-2 card-body">
                  <div class="row">
                    <!-- VALUE -->
                    <span><h2 class="total">2,458</h2></span>
                  </div>
                  <div class="text-left d-flex flex-row">
                    <img src="/assets/images/house.svg" />
                    <div class="d-flex flex-column ml-2">
                      <!--OF METRIC-->
                      <h5 class="mb-0">
                        People Housed
                      </h5>
                      <!-- YEAR -->
                      <h5 class="text-muted">
                        in <span class="year">2018</span>
                      </h5>
                    </div>
                  </div>
                </div>
                <div class="bg-white card-footer">
                  <div
                    class="text-left widget-footer-icon d-flex flex-row card-bottom"
                  >
                    <span class="trend-icon d-flex align-items-center">
                      <img src="/assets/images/caret-up.svg" />
                    </span>
                    <div
                      class="text-muted text-wrap pt-1 pr-1 widget-footer-text ml-2"
                    >
                      Up by <span class="change">205</span> in the last year
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg">
            <div class="card coa-metric-card">
              <div>
                <span
                  data-toggle="tooltip"
                  data-html="true"
                  data-placement="bottom"
                  title="<p class='text-left'>
                    This number represents the beds added to Austin’s Continuums of Care in a fiscal
                    year. Both shelter and housing placements are included in this count.
                    </p>"
                  class="info-icon float-right mr-1"
                  aria-expanded="false"
                  ><img src="/assets/images/information.svg" />
                </span>
                <div class="pb-2 card-body">
                  <div class="row">
                    <!-- VALUE -->
                    <span><h2 class="total">1,199</h2></span>
                  </div>
                  <div class="text-left d-flex flex-row">
                    <img src="/assets/images/apartments.svg" />

                    <div class="d-flex flex-column ml-2">
                      <!--METRIC-->
                      <h5 class="mb-0">
                        New Beds
                      </h5>
                      <!-- YEAR -->
                      <h5 class="text-muted">
                        in <span class="year">2019</span>
                      </h5>
                    </div>
                  </div>
                </div>
                <div class="bg-white card-footer">
                  <div
                    class="text-left widget-footer-icon d-flex flex-row card-bottom"
                  >
                    <span class="trend-icon d-flex align-items-center">
                      <img src="/assets/images/caret-up.svg" />
                    </span>
                    <div
                      class="text-muted text-wrap pt-1 pr-1 widget-footer-text ml-2"
                    >
                      Up by <span class="change">422</span> in the last year
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div>
      <div class="container d-flex flex-column">
        <div class="row">
          <!-- Newly Homeless -->
          <div class="col-md viz-widget card">
            <div class="row">
              <h2 class="col">Newly Homeless</h2>
              <span
                class="info-icon float-right mr-1 col-sm-1 d-flex justify-content-end"
                data-toggle="viz-tooltip"
                data-html="true"
                data-placement="bottom"
                data-title="placeholder for 1st tooltip, if you see me its bad"
                aria-expanded="false"
                style="display: none;"
                ><img src="/assets/images/information.svg" />
              </span>
            </div>

            <ul
              class="nav nav-pills mb-3"
              id="section-1-pills-tab"
              role="tablist"
            >
              <li class="nav-item">
                <a
                  class="nav-link active"
                  id="section-1-layer-1-tab"
                  data-toggle="pill"
                  href="#section-1-layer-1"
                  role="tab"
                  aria-controls="section-1-layer-1"
                  aria-selected="true"
                  >Individuals</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  id="section-1-layer-2-tab"
                  data-toggle="pill"
                  href="#section-1-layer-2"
                  role="tab"
                  aria-controls="section-1-layer-2"
                  aria-selected="false"
                  >Demographics</a
                >
              </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
              <div
                class="tab-pane fade show active"
                id="section-1-layer-1"
                role="tabpanel"
                aria-labelledby="section-1-layer-1-tab"
              ></div>
              <div
                class="tab-pane fade"
                id="section-1-layer-2"
                role="tabpanel"
                aria-labelledby="section-1-layer-2-tab"
              ></div>
            </div>
          </div>
          <!-- Shelter -->
          <div class="col-md viz-widget card">
            <div class="row">
              <h2 class="col">Shelter</h2>
              <span
                class="info-icon float-right mr-1 col-sm-1 d-flex justify-content-end"
                data-toggle="viz-tooltip"
                data-html="true"
                data-placement="bottom"
                data-title="placeholder for 1st tooltip, if you see me its bad"
                aria-expanded="false"
                style="display: none;"
                ><img src="/assets/images/information.svg" />
              </span>
            </div>
            <ul
              class="nav nav-pills mb-3"
              id="section-2-pills-tab"
              role="tablist"
            >
              <li class="nav-item">
                <a
                  class="nav-link active"
                  id="section-2-layer-1-tab"
                  data-toggle="pill"
                  href="#section-2-layer-1"
                  role="tab"
                  aria-controls="section-2-layer-1"
                  aria-selected="true"
                  >Beds</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  id="section-2-layer-2-tab"
                  data-toggle="pill"
                  href="#section-2-layer-2"
                  role="tab"
                  aria-controls="section-2-layer-2"
                  aria-selected="false"
                  >Individuals</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  id="section-2-layer-3-tab"
                  data-toggle="pill"
                  href="#section-2-layer-3"
                  role="tab"
                  aria-controls="section-2-layer-3"
                  aria-selected="false"
                  >Demographics</a
                >
              </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
              <div
                class="tab-pane fade show active"
                id="section-2-layer-1"
                role="tabpanel"
                aria-labelledby="section-2-layer-1-tab"
              ></div>
              <div
                class="tab-pane fade"
                id="section-2-layer-2"
                role="tabpanel"
                aria-labelledby="section-2-layer-2-tab"
              ></div>
              <div
                class="tab-pane fade"
                id="section-2-layer-3"
                role="tabpanel"
                aria-labelledby="section-2-layer-3-tab"
              ></div>
            </div>
          </div>
        </div>
        <div class="row">
          <!-- Housing -->
          <div class="col-md viz-widget card">
            <div class="row">
              <h2 class="col">Housing</h2>
              <span
                class="info-icon float-right mr-1 col-sm-1 d-flex justify-content-end"
                data-toggle="viz-tooltip"
                data-html="true"
                data-placement="bottom"
                data-title="placeholder for 1st tooltip, if you see me its bad"
                aria-expanded="false"
                style="display: none;"
                ><img src="/assets/images/information.svg" />
              </span>
            </div>

            <ul
              class="nav nav-pills mb-3"
              id="section-3-pills-tab"
              role="tablist"
            >
              <li class="nav-item">
                <a
                  class="nav-link active"
                  id="section-3-layer-1-tab"
                  data-section="3"
                  data-layer="1"
                  data-toggle="pill"
                  href="#section-3-layer-1"
                  role="tab"
                  aria-controls="section-3-layer-1"
                  aria-selected="true"
                  >Beds</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  id="section-3-layer-2-tab"
                  data-toggle="pill"
                  href="#section-3-layer-2"
                  role="tab"
                  aria-controls="section-3-layer-2"
                  aria-selected="false"
                  >Individuals</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  id="section-3-layer-3-tab"
                  data-toggle="pill"
                  href="#section-3-layer-3"
                  role="tab"
                  aria-controls="section-3-layer-3"
                  aria-selected="false"
                  >Demographics</a
                >
              </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
              <div
                class="tab-pane fade show active"
                id="section-3-layer-1"
                role="tabpanel"
                aria-labelledby="section-3-layer-1-tab"
              ></div>
              <div
                class="tab-pane fade"
                id="section-3-layer-2"
                role="tabpanel"
                aria-labelledby="section-3-layer-2-tab"
              ></div>
              <div
                class="tab-pane fade"
                id="section-3-layer-3"
                role="tabpanel"
                aria-labelledby="section-3-layer-3-tab"
              ></div>
            </div>
          </div>
          <!-- Returns to Homeless -->
          <div class="col-md viz-widget card">
            <div class="row">
              <h2 class="col">Returns to Homeless</h2>
              <span
                class="info-icon float-right mr-1 col-sm-1 d-flex justify-content-end"
                data-toggle="viz-tooltip"
                data-html="true"
                data-placement="bottom"
                data-title="placeholder for 1st tooltip, if you see me its bad"
                aria-expanded="false"
                style="display: none;"
                ><img src="/assets/images/information.svg" />
              </span>
            </div>
            <ul
              class="nav nav-pills mb-3"
              id="section-4-pills-tab"
              role="tablist"
            >
              <li class="nav-item">
                <a
                  class="nav-link active"
                  id="section-4-layer-1-tab"
                  data-toggle="pill"
                  href="#section-4-layer-1"
                  role="tab"
                  aria-controls="section-4-layer-1"
                  aria-selected="true"
                  >Individuals</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  id="section-4-layer-2-tab"
                  data-toggle="pill"
                  href="#section-4-layer-2"
                  role="tab"
                  aria-controls="section-4-layer-2"
                  aria-selected="false"
                  >Demographics</a
                >
              </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
              <div
                class="tab-pane fade show active"
                id="section-4-layer-1"
                role="tabpanel"
                aria-labelledby="section-4-layer-1-tab"
              ></div>
              <div
                class="tab-pane fade"
                id="section-4-layer-2"
                role="tabpanel"
                aria-labelledby="section-4-layer-2-tab"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="container py-5">
      <div class="row">
        <div class="col-md-4">
          <button
            type="button"
            class="btn btn-primary btn-lg coa-big-ol-button coa-services"
          >
            City Services
          </button>
        </div>
        <div class="col-md-4">
          <button
            type="button"
            class="btn btn-primary btn-lg coa-big-ol-button coa-glossary"
          >
            Glossary
          </button>
        </div>
        <div class="col-md-4">
          <button
            type="button"
            class="btn btn-primary btn-lg coa-big-ol-button coa-resources"
          >
            Resources
          </button>
        </div>
      </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <script>
      function getActiveContent() {
        let activeViz = $("#section-3-pills-tab").find(".active");
        let section = activeViz[0].dataset.section;
        let layer = activeViz[0].dataset.layer;
        // match json object by section, layer
        let tooltipContent = vizList.filter(
          (viz) => viz.section == section && viz.layer == layer
        )[0].info;
        if (tooltipContent !== undefined) {
          return tooltipContent;
        }
      }
      $(
        "body > div:nth-child(2) > div > div:nth-child(2) > div:nth-child(1) > div.row > span"
      ).hover(function () {
        this.dataset.originalTitle = `${getActiveContent()}`;
      });
    </script>
  </body>
</html>
